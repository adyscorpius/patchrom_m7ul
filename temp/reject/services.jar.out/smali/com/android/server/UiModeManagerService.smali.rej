*** UiModeManagerService.smali	2013-08-21 11:30:28.663201322 -0700
--- UiModeManagerService.smali	2013-08-21 11:29:26.280809183 -0700
***************
*** 3,8 ****
  .source "UiModeManagerService.java"
  
  
  # static fields
  .field private static final ACTION_UPDATE_NIGHT_MODE:Ljava/lang/String; = "com.android.server.action.UPDATE_NIGHT_MODE"
  
--- 3,16 ----
  .source "UiModeManagerService.java"
  
  
+ # annotations
+ .annotation system Ldalvik/annotation/MemberClasses;
+     value = {
+         Lcom/android/server/UiModeManagerService$Injector;
+     }
+ .end annotation
+ 
+ 
  # static fields
  .field private static final ACTION_UPDATE_NIGHT_MODE:Ljava/lang/String; = "com.android.server.action.UPDATE_NIGHT_MODE"
  
***************
*** 80,85 ****
  
  .field private mNightMode:I
  
  .field private mNotificationManager:Landroid/app/NotificationManager;
  
  .field private final mResultReceiver:Landroid/content/BroadcastReceiver;
--- 88,99 ----
  
  .field private mNightMode:I
  
+ .field mNormalType:I
+     .annotation build Landroid/annotation/MiuiHook;
+         value = .enum Landroid/annotation/MiuiHook$MiuiHookType;->NEW_FIELD:Landroid/annotation/MiuiHook$MiuiHookType;
+     .end annotation
+ .end field
+ 
  .field private mNotificationManager:Landroid/app/NotificationManager;
  
  .field private final mResultReceiver:Landroid/content/BroadcastReceiver;
***************
*** 118,123 ****
  .method public constructor <init>(Landroid/content/Context;)V
      .locals 8
      .parameter "context"
  
      .prologue
      const/4 v3, 0x1
--- 132,140 ----
  .method public constructor <init>(Landroid/content/Context;)V
      .locals 8
      .parameter "context"
+     .annotation build Landroid/annotation/MiuiHook;
+         value = .enum Landroid/annotation/MiuiHook$MiuiHookType;->CHANGE_CODE:Landroid/annotation/MiuiHook$MiuiHookType;
+     .end annotation
  
      .prologue
      const/4 v3, 0x1
***************
*** 126,131 ****
  
      invoke-direct {p0}, Landroid/app/IUiModeManager$Stub;-><init>()V
  
      new-instance v2, Ljava/lang/Object;
  
      invoke-direct {v2}, Ljava/lang/Object;-><init>()V
--- 143,150 ----
  
      invoke-direct {p0}, Landroid/app/IUiModeManager$Stub;-><init>()V
  
+     iput v3, p0, Lcom/android/server/UiModeManagerService;->mNormalType:I
+ 
      new-instance v2, Ljava/lang/Object;
  
      invoke-direct {v2}, Ljava/lang/Object;-><init>()V
***************
*** 285,290 ****
  
      invoke-virtual {v2, v5, v0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
  
      const-string v2, "power"
  
      invoke-virtual {p1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
--- 304,313 ----
  
      invoke-virtual {v2, v5, v0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;
  
+     iget-object v2, p0, Lcom/android/server/UiModeManagerService;->mContext:Landroid/content/Context;
+ 
+     invoke-static {p0, v2}, Lcom/android/server/UiModeManagerService$Injector;->registerUIModeScaleChangedOjbserver(Lcom/android/server/UiModeManagerService;Landroid/content/Context;)V
+ 
      const-string v2, "power"
  
      invoke-virtual {p1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
***************
*** 1218,1223 ****
  .method final updateConfigurationLocked(Z)V
      .locals 4
      .parameter "sendIt"
  
      .prologue
      iget-boolean v2, p0, Lcom/android/server/UiModeManagerService;->mTelevision:Z
--- 1241,1249 ----
  .method final updateConfigurationLocked(Z)V
      .locals 4
      .parameter "sendIt"
+     .annotation build Landroid/annotation/MiuiHook;
+         value = .enum Landroid/annotation/MiuiHook$MiuiHookType;->CHANGE_CODE:Landroid/annotation/MiuiHook$MiuiHookType;
+     .end annotation
  
      .prologue
      iget-boolean v2, p0, Lcom/android/server/UiModeManagerService;->mTelevision:Z
***************
*** 1291,1297 ****
  
      .end local v1           #uiMode:I
      :cond_2
!     iget v1, p0, Lcom/android/server/UiModeManagerService;->mDefaultUiModeType:I
  
      goto :goto_0
  
--- 1317,1323 ----
  
      .end local v1           #uiMode:I
      :cond_2
!     iget v1, p0, Lcom/android/server/UiModeManagerService;->mNormalType:I
  
      goto :goto_0
  
